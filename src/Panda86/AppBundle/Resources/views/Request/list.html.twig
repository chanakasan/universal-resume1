{% extends '::admin-app.html.twig' %}

{% block title %}{{ parent() }} - List of all Requests {% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" type="text/css" href="/assets/DataTables/dataTables.css">
    <link rel="stylesheet" type="text/css" href="/assets/colorbox/colorbox.css" media="all">
    <link rel="stylesheet" type="text/css" href="/app/css/request/list.css" media="all">
{% endblock %}

{% block body %}
    <div class="row">
        <div class="span10 offset1">
            <h2>Requests for vehicle reservations</h2><br/>
        </div>
    </div>
    <div class="content-nav">
        <div class="row">
            <div class="span10 offset1">
                <ul class="nav nav-pills">
                    <li id="nPending">
                        <a href="#">Pending
                            <span id="pending" class="badge"></span>
                        </a>
                    </li>
                    <li id="nApproved">
                        <a href="#">Approved</a>
                    </li>
                    <li id="nDisapproved">
                        <a href="#">Disapproved</a>
                    </li>
                    <li id="nExpired">
                        <a href="#">Expired</a>
                    </li>
                    <li class="active">
                        <a href="#">All</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <table id="requests_list" class="table table-striped table-bordered">
        <thead>
        <tr>
            <th>Req ID</th>
            <th>Requester</th>
            <th>Requested vehicle</th>
            <th>Requested Date/Time</th>
            <th>Purpose of travel</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for entity in entities %}
            {% if entity['request'].status == 2 %}
                {% set class = 'error' %}
            {% elseif entity['request'].status == 1 %}
                {% set class = 'success' %}
            {% else %}
                {% set class = 'warning' %}
            {% endif %}
            <tr class="{{ class }}">
                <td>{{ entity['request'].id }}</td>
                <td>{{ entity['owner'].name }}</td>
                <td>{{ entity['request'].vtype.name }}</td>
                <td>{% if entity['request'].pickuptime %}{{ entity['request'].pickuptime|date('Y-m-d H:i:s') }}{% endif %}</td>
                <td>{{ entity['request'].purpose }}</td>
                <td>
                    <a href="{{ path('request_show', { 'id': entity['request'].id }) }}">Show</a>
                    {% if entity['request'].status == 0 %}|
                        <a href="{{ path('approve_new', { 'id': entity['request'].id }) }}">Approve</a>
                        {#<a href="{{ path('disapprove_new', { 'id': entity['request'].id }) }}">Disapprove</a>#}
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="/assets/DataTables/dataTables.js"></script>
    <script type="text/javascript" src="/assets/DataTables/DT_bootstrap.js"></script>
    <script type="text/javascript" src="/assets/colorbox/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="/app/js/request/list.js"></script>
{% endblock %}